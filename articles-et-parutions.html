<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutomaTest - Articles et parutions</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="favicon_batman.ico" type="image/x-ico">
</head>
<body>
    <header>
        <h1><a href="index.html">Bienvenue sur AutomaTest</a></h1>
        <nav>
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="histoire-des-testes.html">Histoire des tests</a></li>
                <li><a href="articles-et-parutions.html">Articles et parutions</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h2>Articles et parutions</h2>
        <div id="articles"></div>

        <div class="batman-container">
            <img src="batman.svg" alt="Batman" class="batman">
          </div>

        <section>
            <h2>Ajouter un article</h2>
            <form id="add-article-form">
                <label for="titre">Titre :</label>
                <input type="text" id="titre" name="titre" required>
                <br>
                <label for="contenu">Contenu :</label>
                <textarea id="contenu" name="contenu" required></textarea>
                <br>
                <label for="lien">Lien :</label>
                <input type="text" id="lien" name="lien" required>
                <br>
                <button type="submit">Ajouter l'article</button>
            </form>
        </section>
        
        <script>
            const apiUrl = 'http://localhost:3001/api/articles';

            function loadArticles() {
                fetch(apiUrl)
                    .then((response) => response.json())
                    .then((articles) => {
                        const articlesDiv = document.getElementById('articles');
                        articlesDiv.innerHTML = '';

                        articles.forEach((article) => {
                            const h3 = document.createElement('h3');
                            h3.textContent = article.titre;
                            articlesDiv.appendChild(h3);

                            const p = document.createElement('p');
                            p.textContent = article.contenu;
                            articlesDiv.appendChild(p);
                        });
                    });
            }
            
            document.getElementById('add-article-form').addEventListener('submit', (e) => {
                e.preventDefault();

                const titre = document.getElementById('titre').value;
                const contenu = document.getElementById('contenu').value;
                const lien = document.getElementById('lien').value;

                fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        titre,
                        contenu,
                        lien,
                    }),
                })
                    .then((response) => {
                        if (response.ok) {
                            alert('Article ajouté avec succès');
                            // Refresh page
                            window.location.reload();
                        } else {
                            alert('Erreur lors de lajout de larticle');
                        }
                    })
                    .catch((error) => {
                        console.error('Erreur:', error);
                    });
            });

            // Load articles
            loadArticles();
        </script>
    </main>

    <footer>
        <p>&copy; 2023 AutomaTest.</p>
    </footer>
</body>
</html>
